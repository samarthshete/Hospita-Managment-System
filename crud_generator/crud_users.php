<?php$table = 'users';if(isset($_POST['submit'])) {$user_id=$_POST['user_id'];$role_id=$_POST['role_id'];$dept_id=$_POST['dept_id'];$username=$_POST['username'];$login=$_POST['login'];$password=$_POST['password'];$email_d=$_POST['email_d'];$mobile_no=$_POST['mobile_no'];$created_by=$_POST['created_by'];$created_on=$_POST['created_on'];$updated_by=$_POST['updated_by'];$updated_on=$_POST['updated_on'];$active=$_POST['active'];$last_login_on=$_POST['last_login_on'];$last_logout_at=$_POST['last_logout_at'];$photo=$_POST['photo'];$login_status=$_POST['login_status'];if (session_status() !== PHP_SESSION_ACTIVE) {session_start();}date_default_timezone_set('asia/kolkata');$created_by = $_SESSION['ActiveUserId'];$created_on = date("Y-m-d H:i:s");include_once 'connection.php';$table_fields = "user_id,role_id,dept_id,username,login,password,email_d,mobile_no,created_by,created_on,updated_by,updated_on,active,last_login_on,last_logout_at,photo,login_status";$table_values =  "'$user_id','$role_id','$dept_id','$username','$login','$password','$email_d','$mobile_no','$created_by','$created_on','$updated_by','$updated_on','$active','$last_login_on','$last_logout_at','$photo','$login_status'";$table_query = "INSERT INTO $table (" . $table_fields . ") VALUES (" . $table_values . ")";if(mysqli_query($con, $table_query)) {echo "<script>alert('New record is added successfully to $table master');window.location.href='dashboard.php?page=crud_$table';</script>";} else {echo "<script>alert('ERROR: 001 - This record can't be added ...');window.location.href='dashboard.php?page=crud_$table';</script>";}} elseif (isset($_GET['action'])) {$action = $_GET['action'];if(isset($_GET['id'])){$id=$_GET['id'];}switch($action){case 'edit':$role_id=$_POST['role_id'];$dept_id=$_POST['dept_id'];$username=$_POST['username'];$login=$_POST['login'];$password=$_POST['password'];$email_d=$_POST['email_d'];$mobile_no=$_POST['mobile_no'];$created_by=$_POST['created_by'];$created_on=$_POST['created_on'];$updated_by=$_POST['updated_by'];$updated_on=$_POST['updated_on'];$active=$_POST['active'];$last_login_on=$_POST['last_login_on'];$last_logout_at=$_POST['last_logout_at'];$photo=$_POST['photo'];$login_status=$_POST['login_status'];$table_fields_values = "role_id='$role_id',dept_id='$dept_id',username='$username',login='$login',password='$password',email_d='$email_d',mobile_no='$mobile_no',created_by='$created_by',created_on='$created_on',updated_by='$updated_by',updated_on='$updated_on',active='$active',last_login_on='$last_login_on',last_logout_at='$last_logout_at',photo='$photo',login_status='$login_status'";$table_query = "UPDATE $table SET $table_fields_values WHERE id='$id'";if (mysqli_query($con, $table_query)) {echo "<script>alert('Record No.$id is Updated successfully to $table');window.location.href='dashboard.php?crud_$table';</script>";} else {echo "<script>alert('ERROR: 001 - This record can't be added ...');window.location.href='dashboard.php?page=crud_$table';</script>";}break;case 'delete':$table_query = "DELETE FROM users WHERE user_id='".$id."'";if (mysqli_query($con, $table_query)) {echo "<script>alert('Record No. $id is deleted successfully from $table master');window.location.href='dashboard.php?page=crud_$table';</script>";}else {echo "<script>alert('ERROR: 001 - This record can't be added ...');window.location.href='dashboard.php?page=crud_$table';</script>";}break;default: echo "Program Entered into DEFAULT";}}?><!-- Content Header (Page header) --><section class="content-header"><h1>Master Records<small>Preview</small></h1><ol class="breadcrumb"><li><a href="dashboard.php"><i class="fa fa-dashboard"></i> Home</a></li><li class="active"><?php echo $table; ?> Master Records </li></ol></section><section class="content"><div class="row"><div class="col-md-12"><!------CONTROL TABS START------><div class="nav-tabs-custom"><ul class="nav nav-tabs pull-right"><li><button class="btn btn-block btn-info" href="import.php?action=import&table=<?php echo $table; ?>" target="_blank"><i class="fa fa-upload"></i>&nbsp;&nbsp;Import</button>&nbsp;&nbsp;<li><li><button class="btn btn-block btn-warning" href="printpdf.php?action=print&table=<?php echo $table; ?>" target="_blank"><i class="fa fa-file-pdf-o"></i>&nbsp;&nbsp;PDF</button>&nbsp;&nbsp;<li><li><button class="btn btn-block btn-primary" href="export.php?action=export&table=<?php echo $table; ?>" target="_blank"><i class="fa fa-file-excel-o"></i>&nbsp;&nbsp;CSV</button>&nbsp;&nbsp;</li><li><a href="#add" data-toggle="tab" class="btn bg-green-active"><i class="fa fa-plus-square"></i>&nbsp;&nbsp;New <?php echo $table; ?></a></li><li class="active"><a href="#list" data-toggle="tab" class="btn bg-primary"><i class="fa fa-list"></i>&nbsp;&nbsp;<?php echo $table; ?> List </a></li><li class="pull-left header"><i class="fa fa-th"></i> Manage <?php echo $table; ?><li></ul><!------CONTROL TABS END------><div class="tab-content"><!----TABLE LISTING STARTS--><div class="tab-pane active" id="list"><section class="content"><div class="row"><div class="box border-top-solid"><div class="box-body table-responsive"><table id="example1" class="table table-bordered table-striped "><thead><tr><th>user_id</th><th>role_id</th><th>dept_id</th><th>username</th><th>login</th><th>password</th><th>email_d</th><th>mobile_no</th><th>created_by</th><th>created_on</th><th>updated_by</th><th>updated_on</th><th>active</th><th>last_login_on</th><th>last_logout_at</th><th>photo</th><th>login_status</th><th style="width: 100px;" class="text-right">Option</th></tr></thead><?php require_once 'connection.php';$table_query="SELECT * FROM ".$table;$result=  mysqli_query($con, $table_query);while ($tresult_array = mysqli_fetch_array($result)) {echo "<tr>";echo "<td>".$tresult_array['user_id']."</td>";echo "<td>".$tresult_array['role_id']."</td>";echo "<td>".$tresult_array['dept_id']."</td>";echo "<td>".$tresult_array['username']."</td>";echo "<td>".$tresult_array['login']."</td>";echo "<td>".$tresult_array['password']."</td>";echo "<td>".$tresult_array['email_d']."</td>";echo "<td>".$tresult_array['mobile_no']."</td>";echo "<td>".$tresult_array['created_by']."</td>";echo "<td>".$tresult_array['created_on']."</td>";echo "<td>".$tresult_array['updated_by']."</td>";echo "<td>".$tresult_array['updated_on']."</td>";echo "<td>".$tresult_array['active']."</td>";echo "<td>".$tresult_array['last_login_on']."</td>";echo "<td>".$tresult_array['last_logout_at']."</td>";echo "<td>".$tresult_array['photo']."</td>";echo "<td>".$tresult_array['login_status']."</td>";echo "<td class='text-right'>";echo "<a href='dashboard.php?page=crud_users&action=edit&id=".$tresult_array['user_id']."' class='btn btn-info btn-flat btn-xs'>Edit</a>";echo "<a onclick='return delFunction();' href='dashboard.php?page=crud_users&action=delete&id=".$tresult_array['user_id']."' class='btn btn-warning btn-flat btn-xs'>Delete</a>";echo "</td>";echo "</tr>";} ?></tbody></table></div></div><!-- /.box-body --><div class="box-footer"><button type="reset" onclick="window.location.href = 'dashboard.php';" class="btn btn-warning"><i class="fa fa-arrow-circle-o-left">  </i> Back</button></div></div></section></div><!----TABLE LISTING ENDS---><!----CREATION FORM STARTS----><div class="tab-pane" id="add" style="padding: 5px"><!-- Horizontal Form --><div class="box box-info"><div class="box-header with-border"><h3 class="box-title">New <?php echo $table; ?> Form</h3></div><!-- /.box-header --><!-- form start --><form class="form-horizontal" action="dashboard.php?page=crud_users" method="post"><div class="box-body"><div class="form-group"><label for='users-user_id' class='col-sm-2 control-label'>user_id</label><div class="col-sm-10"><input class="form-control" type="text" name="user_id" id="user_id"></div></div><div class="form-group"><label for='users-role_id' class='col-sm-2 control-label'>role_id</label><div class="col-sm-10"><input class="form-control" type="text" name="role_id" id="role_id"></div></div><div class="form-group"><label for='users-dept_id' class='col-sm-2 control-label'>dept_id</label><div class="col-sm-10"><input class="form-control" type="text" name="dept_id" id="dept_id"></div></div><div class="form-group"><label for='users-username' class='col-sm-2 control-label'>username</label><div class="col-sm-10"><input class="form-control" type="text" name="username" id="username"></div></div><div class="form-group"><label for='users-login' class='col-sm-2 control-label'>login</label><div class="col-sm-10"><input class="form-control" type="text" name="login" id="login"></div></div><div class="form-group"><label for='users-password' class='col-sm-2 control-label'>password</label><div class="col-sm-10"><input class="form-control" type="text" name="password" id="password"></div></div><div class="form-group"><label for='users-email_d' class='col-sm-2 control-label'>email_d</label><div class="col-sm-10"><input class="form-control" type="text" name="email_d" id="email_d"></div></div><div class="form-group"><label for='users-mobile_no' class='col-sm-2 control-label'>mobile_no</label><div class="col-sm-10"><input class="form-control" type="text" name="mobile_no" id="mobile_no"></div></div><div class="form-group"><label for='users-created_by' class='col-sm-2 control-label'>created_by</label><div class="col-sm-10"><input class="form-control" type="text" name="created_by" id="created_by"></div></div><div class="form-group"><label for='users-created_on' class='col-sm-2 control-label'>created_on</label><div class="col-sm-10"><input class="form-control" type="text" name="created_on" id="created_on"></div></div><div class="form-group"><label for='users-updated_by' class='col-sm-2 control-label'>updated_by</label><div class="col-sm-10"><input class="form-control" type="text" name="updated_by" id="updated_by"></div></div><div class="form-group"><label for='users-updated_on' class='col-sm-2 control-label'>updated_on</label><div class="col-sm-10"><input class="form-control" type="text" name="updated_on" id="updated_on"></div></div><div class="form-group"><label for='users-active' class='col-sm-2 control-label'>active</label><div class="col-sm-10"><input class="form-control" type="text" name="active" id="active"></div></div><div class="form-group"><label for='users-last_login_on' class='col-sm-2 control-label'>last_login_on</label><div class="col-sm-10"><input class="form-control" type="text" name="last_login_on" id="last_login_on"></div></div><div class="form-group"><label for='users-last_logout_at' class='col-sm-2 control-label'>last_logout_at</label><div class="col-sm-10"><input class="form-control" type="text" name="last_logout_at" id="last_logout_at"></div></div><div class="form-group"><label for='users-photo' class='col-sm-2 control-label'>photo</label><div class="col-sm-10"><input class="form-control" type="text" name="photo" id="photo"></div></div><div class="form-group"><label for='users-login_status' class='col-sm-2 control-label'>login_status</label><div class="col-sm-10"><input class="form-control" type="text" name="login_status" id="login_status"></div></div></div><!-- /.box-body --><div class="box-footer"><button type="reset" onclick="window.location.href = 'dashboard.php';" class="btn btn-warning"><i class="fa fa-ban">  </i> Cancel</button><button type="submit" class="btn btn-info pull-right" name="submit"><i class="fa fa-database">  </i> Save New <?php echo $table; ?> Record</button></div><!-- /.box-footer --></form></div><!-- /.box --></div><!----CREATION FORM ENDS--></div></div></div></div></section> <!-- Edit Modal Starts Here --><div class="modal fade" id="editModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button><h4 class="modal-title" id="myModalLabel">users Update</h4></div><div class="modal-body"><form class="form-horizontal" role="form" action="dashboard.php?page=crud_users&action=edit" method="post"><div class="form-group"><label for='users-user_id' class='col-sm-2 control-label'>user_id</label><div class="col-sm-10"><input class="form-control" type="text" name="user_id" id="user_id"  readonly></div></div><div class="form-group"><label for='users-role_id' class='col-sm-2 control-label'>role_id</label><div class="col-sm-10"><input class="form-control" type="text" name="role_id" id="role_id"></div></div><div class="form-group"><label for='users-dept_id' class='col-sm-2 control-label'>dept_id</label><div class="col-sm-10"><input class="form-control" type="text" name="dept_id" id="dept_id"></div></div><div class="form-group"><label for='users-username' class='col-sm-2 control-label'>username</label><div class="col-sm-10"><input class="form-control" type="text" name="username" id="username"></div></div><div class="form-group"><label for='users-login' class='col-sm-2 control-label'>login</label><div class="col-sm-10"><input class="form-control" type="text" name="login" id="login"></div></div><div class="form-group"><label for='users-password' class='col-sm-2 control-label'>password</label><div class="col-sm-10"><input class="form-control" type="text" name="password" id="password"></div></div><div class="form-group"><label for='users-email_d' class='col-sm-2 control-label'>email_d</label><div class="col-sm-10"><input class="form-control" type="text" name="email_d" id="email_d"></div></div><div class="form-group"><label for='users-mobile_no' class='col-sm-2 control-label'>mobile_no</label><div class="col-sm-10"><input class="form-control" type="text" name="mobile_no" id="mobile_no"></div></div><div class="form-group"><label for='users-created_by' class='col-sm-2 control-label'>created_by</label><div class="col-sm-10"><input class="form-control" type="text" name="created_by" id="created_by"></div></div><div class="form-group"><label for='users-created_on' class='col-sm-2 control-label'>created_on</label><div class="col-sm-10"><input class="form-control" type="text" name="created_on" id="created_on"></div></div><div class="form-group"><label for='users-updated_by' class='col-sm-2 control-label'>updated_by</label><div class="col-sm-10"><input class="form-control" type="text" name="updated_by" id="updated_by"></div></div><div class="form-group"><label for='users-updated_on' class='col-sm-2 control-label'>updated_on</label><div class="col-sm-10"><input class="form-control" type="text" name="updated_on" id="updated_on"></div></div><div class="form-group"><label for='users-active' class='col-sm-2 control-label'>active</label><div class="col-sm-10"><input class="form-control" type="text" name="active" id="active"></div></div><div class="form-group"><label for='users-last_login_on' class='col-sm-2 control-label'>last_login_on</label><div class="col-sm-10"><input class="form-control" type="text" name="last_login_on" id="last_login_on"></div></div><div class="form-group"><label for='users-last_logout_at' class='col-sm-2 control-label'>last_logout_at</label><div class="col-sm-10"><input class="form-control" type="text" name="last_logout_at" id="last_logout_at"></div></div><div class="form-group"><label for='users-photo' class='col-sm-2 control-label'>photo</label><div class="col-sm-10"><input class="form-control" type="text" name="photo" id="photo"></div></div><div class="form-group"><label for='users-login_status' class='col-sm-2 control-label'>login_status</label><div class="col-sm-10"><input class="form-control" type="text" name="login_status" id="login_status"></div></div><button type="submit" class="btn btn-primary">Submit for Updation</button></form></div></div><!-- /.modal-content --></div><!-- /.modal-dialog --></div><!-- /.modal --><script src="../assets/js/jquery.min.js"></script><script src="../assets/js/bootstrap.min.js"></script><script>$(document).on("click", ".userseditDialog", function (e) { e.preventDefault();var _self = $(this);var myData = _self.data('id');$("#Id").val(myData);0$("#user_id").val(res[0]);$("#role_id").val(res[1]);$("#dept_id").val(res[2]);$("#username").val(res[3]);$("#login").val(res[4]);$("#password").val(res[5]);$("#email_d").val(res[6]);$("#mobile_no").val(res[7]);$("#created_by").val(res[8]);$("#created_on").val(res[9]);$("#updated_by").val(res[10]);$("#updated_on").val(res[11]);$("#active").val(res[12]);$("#last_login_on").val(res[13]);$("#last_logout_at").val(res[14]);$("#photo").val(res[15]);$("#login_status").val(res[16]);$(_self.attr('href')).modal('show');});</script><script> function delFunction() { return confirm("Do you want to delete this record?");}</script><script>$(function () {$("#example1").DataTable();});</script>